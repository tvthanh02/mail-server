<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <p>
      confirm:
      <span class="status">false</span>
    </p>
    <button class="btn-send">Send Email</button>
    <button class="btn-check">Check confirm email</button>

    <script type="text/javascript">
      const btnSend = document.querySelector(".btn-send");
      const btnCheck = document.querySelector(".btn-check");
      const now = Date.now();

      const objectSend = {
        receiveEmail: "tvthanhdev02@gmail.com",
        subject: "Mã bảo mật",
        text: "Đây là mã quan trọng bạn cần bảo mật ",
        html: `<a href="http://127.0.0.1:8000/api/v1/confirm-email?code=123&d=${now}">Click to verify</a>`,
      };

      btnSend.addEventListener("click", () => {
        fetch("http://127.0.0.1:8000/api/v1/send-email", {
          method: "post",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(objectSend),
        })
          .then((response) => response.json())
          .then((data) => {
            const { error } = data;
            if (error) console.log(error);
          })
          .catch((error) => console.log(error));
      });

      btnCheck.addEventListener("click", () => {
        fetch("http://127.0.0.1:8000/api/v1/check-status-confirm?code=123")
          .then((response) => response.json())
          .then((data) => {
            const { confirm } = data;
            document.querySelector(".status").innerHTML = confirm;
          })
          .catch((error) => console.log(error));
      });
    </script>
  </body>
</html>
